window.PostsController = ($scope) ->
  clicking_post = null

  $scope.posts = [
    {
      id: 1,
      date: '5 minutes ago',
      question: 'Hey love! Where did we eat last Friday?',
      expanded: false,
    },
    {
      id: 2,
      date: '10 minutes ago',
      question: 'What\'s the capital of Rhode Island?',
      expanded: false,
    },
  ]

  $scope.click = (post, event) ->
    if !post.expanded
      setTimeout (() -> $(event.target).closest(".card").find(".answer-form .answer").focus().select()), 0
    post.expanded = true
    clicking_post = post

  $(document).click () ->
    $scope.$apply () ->
      for post in $scope.posts
        if clicking_post != post
          post.expanded = false
      clicking_post = null

PostsController.$inject = ['$scope']